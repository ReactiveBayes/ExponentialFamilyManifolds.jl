<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ExponentialFamilyManifolds.jl</title><meta name="title" content="Home · ExponentialFamilyManifolds.jl"/><meta property="og:title" content="Home · ExponentialFamilyManifolds.jl"/><meta property="twitter:title" content="Home · ExponentialFamilyManifolds.jl"/><meta name="description" content="Documentation for ExponentialFamilyManifolds.jl."/><meta property="og:description" content="Documentation for ExponentialFamilyManifolds.jl."/><meta property="twitter:description" content="Documentation for ExponentialFamilyManifolds.jl."/><meta property="og:url" content="https://ReactiveBayes.github.io/ExponentialFamilyManifolds.jl/"/><meta property="twitter:url" content="https://ReactiveBayes.github.io/ExponentialFamilyManifolds.jl/"/><link rel="canonical" href="https://ReactiveBayes.github.io/ExponentialFamilyManifolds.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ExponentialFamilyManifolds.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Natural-manifold-base"><span>Natural manifold base</span></a></li><li><a class="tocitem" href="#Product-manifolds"><span>Product manifolds</span></a></li><li><a class="tocitem" href="#Custom-generic-manifolds"><span>Custom generic manifolds</span></a></li><li><a class="tocitem" href="#Optimization-example"><span>Optimization example</span></a></li><li class="toplevel"><a class="tocitem" href="#Helpers"><span>Helpers</span></a></li><li class="toplevel"><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/ReactiveBayes/ExponentialFamilyManifolds.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ExponentialFamilyManifolds"><a class="docs-heading-anchor" href="#ExponentialFamilyManifolds">ExponentialFamilyManifolds</a><a id="ExponentialFamilyManifolds-1"></a><a class="docs-heading-anchor-permalink" href="#ExponentialFamilyManifolds" title="Permalink"></a></h1><p><code>ExponentialFamilyManifolds.jl</code> provides implementations of manifolds for the natural parameters of exponential family distributions, using <code>Manifolds.jl</code>. These manifolds are compatible with <code>ManifoldsBase.jl</code>, enabling optimization of the natural parameters of exponential family distributions using <code>Manopt.jl</code>.</p><p>The primary operation in the package is the <a href="#ExponentialFamilyManifolds.get_natural_manifold"><code>get_natural_manifold</code></a> function, which returns the appropriate manifold for the natural parameters of a given exponential family member type, its dimension and (if required) conditioner. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.get_natural_manifold" href="#ExponentialFamilyManifolds.get_natural_manifold"><code>ExponentialFamilyManifolds.get_natural_manifold</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_natural_manifold(::Type{T}, dims, conditioner = nothing)</code></pre><p>The function returns a corresponding manifold for the natural parameters of distribution of type <code>T</code>. Optionally accepts the conditioner, which is set to <code>nothing</code> by default. Use empty tuple <code>()</code> for univariate distributions. </p><pre><code class="language-julia-repl hljs">julia&gt; using ExponentialFamily, ExponentialFamilyManifolds

julia&gt; ExponentialFamilyManifolds.get_natural_manifold(Beta, ()) isa ExponentialFamilyManifolds.NaturalParametersManifold
true

julia&gt; ExponentialFamilyManifolds.get_natural_manifold(MvNormalMeanCovariance, (3, )) isa ExponentialFamilyManifolds.NaturalParametersManifold
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds.jl#L39-L54">source</a></section></article><hr/><p>The <a href="#ExponentialFamilyManifolds.get_natural_manifold"><code>get_natural_manifold</code></a> function returns <a href="#ExponentialFamilyManifolds.NaturalParametersManifold"><code>NaturalParametersManifold</code></a> manifold, which is a wrapper around the actual manifold (the base) for the natural parameters that stores extra useful properties and provides the necessary operations for optimization with <code>Manopt.jl</code>. </p><pre><code class="language-julia hljs">using ExponentialFamilyManifolds, ExponentialFamily

ExponentialFamilyManifolds.get_natural_manifold(Beta, (), nothing)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ExponentialFamilyManifolds.NaturalParametersManifold{ℝ, Distributions.Beta, Tuple{}, ManifoldsBase.ProductManifold{ℝ, Tuple{ExponentialFamilyManifolds.ShiftedPositiveNumbers{Static.StaticInt{-1}}, ExponentialFamilyManifolds.ShiftedPositiveNumbers{Static.StaticInt{-1}}}}, Nothing}((), ProductManifold(ShiftedPositiveNumbers(static(-1)), ShiftedPositiveNumbers(static(-1))), nothing)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.NaturalParametersManifold" href="#ExponentialFamilyManifolds.NaturalParametersManifold"><code>ExponentialFamilyManifolds.NaturalParametersManifold</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NaturalParametersManifold(::Type{T}, dims, base, conditioner)</code></pre><p>The manifold for the natural parameters of the distribution of type <code>T</code> with dimensions <code>dims</code>. An internal structure, use <code>get_natural_manifold</code> to create an instance of a manifold for the natural parameters of distribution of type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds.jl#L5-L10">source</a></section></article><p>Its not advised to use the <a href="#ExponentialFamilyManifolds.NaturalParametersManifold"><code>NaturalParametersManifold</code></a> to create a manifold, but instead use the <a href="#ExponentialFamilyManifolds.get_natural_manifold"><code>get_natural_manifold</code></a> function.</p><hr/><h2 id="Natural-manifold-base"><a class="docs-heading-anchor" href="#Natural-manifold-base">Natural manifold base</a><a id="Natural-manifold-base-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-manifold-base" title="Permalink"></a></h2><p>The <a href="#ExponentialFamilyManifolds.get_natural_manifold_base"><code>get_natural_manifold_base</code></a> function returns the base manifold without the wrapper. </p><pre><code class="language-julia hljs">ExponentialFamilyManifolds.get_natural_manifold_base(Beta, (), nothing)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ProductManifold with 2 submanifolds:
 ShiftedPositiveNumbers(static(-1))
 ShiftedPositiveNumbers(static(-1))</code></pre><p>The base manifold, however, does not encode the information about the conditioner, hence, it cannot be used for all exponential members. Additionally, it does not encode the type of the underlying exponential family members. For instance, the <code>LogNormal</code> and the univariate <code>Normal</code> distribution share the same base manifold, yet they represent different members of the exponential family of distributions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.get_natural_manifold_base" href="#ExponentialFamilyManifolds.get_natural_manifold_base"><code>ExponentialFamilyManifolds.get_natural_manifold_base</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(M::NaturalParametersManifold)
get_natural_manifold_base(::Type{T}, dims, conditioner = nothing)</code></pre><p>Returns <code>base</code> manifold for the distribution of type <code>T</code> of dimension <code>dims</code>. Optionally accepts the conditioner, which is set to <code>nothing</code> by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds.jl#L61-L67">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Bernoulli}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Bernoulli</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/bernoulli.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Beta}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Beta</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/beta.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Binomial}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Binomial</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/binomial.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Chisq}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Chisq</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/chisq.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Dirichlet}, dims::Tuple{Int}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Dirichlet</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/dirichlet.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Exponential}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Exponential</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/exponential.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Gamma}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Gamma</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/gamma.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Geometric}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Geometric</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/geometric.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Laplace}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Laplace</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/laplace.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{LogNormal}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>LogNormal</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/lognormal.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{NormalMeanVariance}, ::Tuple{}, conditioner = nothing)</code></pre><p>Get the natural manifold base for the <code>NormalMeanVariance</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/normal.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{MvNormalMeanCovariance}, dims::Tuple{Int}, conditioner = nothing)</code></pre><p>Get the natural manifold base for the <code>MvNormalMeanCovariance</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/normal.jl#L22-L26">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{NegativeBinomial}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>NegativeBinomial</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/negative_binomial.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Pareto}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Pareto</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/pareto.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Poisson}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Poisson</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/poisson.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Rayleigh}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Rayleigh</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/rayleigh.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{Weibull}, ::Tuple{}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>Weibull</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/weibull.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">get_natural_manifold_base(::Type{WishartFast}, ::Tuple{Int}, conditioner=nothing)</code></pre><p>Get the natural manifold base for the <code>WishartFast</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/wishart.jl#L1-L5">source</a></section></article><hr/><h2 id="Product-manifolds"><a class="docs-heading-anchor" href="#Product-manifolds">Product manifolds</a><a id="Product-manifolds-1"></a><a class="docs-heading-anchor-permalink" href="#Product-manifolds" title="Permalink"></a></h2><p>Some base manifolds are known as <em>Product Manifolds</em>, which consist of several manifolds combined together. For example, the natural parameters of a multivariate Normal distribution form a product of a Euclidean vector manifold and a symmetric negative definite matrix manifold. The <a href="#ExponentialFamilyManifolds.partition_point"><code>partition_point</code></a> function takes a plain vector of natural parameters and (typically, but not always) returns a partitioned array for each submanifold in the form of an <code>ArrayPartition</code> from <code>RecursiveArrayTools.jl</code>.</p><pre><code class="language-julia hljs">M = ExponentialFamilyManifolds.get_natural_manifold(Beta, (), nothing)
p = ExponentialFamilyManifolds.partition_point(M, [ 1.0, 2.0 ])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([1.0], [2.0])</code></pre><pre><code class="language-julia hljs">typeof(p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">RecursiveArrayTools.ArrayPartition{Float64, Tuple{SubArray{Float64, 1, Vector{Float64}, Tuple{UnitRange{Int64}}, true}, SubArray{Float64, 1, Vector{Float64}, Tuple{UnitRange{Int64}}, true}}}</code></pre><p>The partitioned point functions as a regular vector but encodes the structure of the product manifold, allowing differentiation between the submanifolds within the vector.</p><pre><code class="language-julia hljs">ExponentialFamilyManifolds.ManifoldsBase.submanifold_component(p, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element view(::Vector{Float64}, 1:1) with eltype Float64:
 1.0</code></pre><pre><code class="language-julia hljs">ExponentialFamilyManifolds.ManifoldsBase.submanifold_component(p, 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element view(::Vector{Float64}, 2:2) with eltype Float64:
 2.0</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.partition_point" href="#ExponentialFamilyManifolds.partition_point"><code>ExponentialFamilyManifolds.partition_point</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">partition_point(M::NaturalParametersManifold, p)
partition_point(::Type{T}, dims, point, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold <code>M</code> of type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds.jl#L72-L77">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Bernoulli}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Bernoulli</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/bernoulli.jl#L10-L14">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Beta}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Beta</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/beta.jl#L12-L16">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Binomial}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Binomial</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/binomial.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Chisq}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Chisq</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/chisq.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Dirichlet}, dims::Tuple{Int}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Dirichlet</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/dirichlet.jl#L13-L17">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Exponential}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Exponential</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/exponential.jl#L10-L14">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Gamma}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Gamma</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/gamma.jl#L13-L17">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Geometric}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Geometric</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/geometric.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Laplace}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Laplace</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/laplace.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{LogNormal}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>LogNormal</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/lognormal.jl#L10-L14">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{NormalMeanVariance}, ::Tuple{}, p, conditioner = nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>NormalMeanVariance</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/normal.jl#L13-L17">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{MvNormalMeanCovariance}, dims::Tuple{Int}, p, conditioner = nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>MvNormalMeanCovariance</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/normal.jl#L34-L38">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{NegativeBinomial}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>NegativeBinomial</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/negative_binomial.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Pareto}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Pareto</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/pareto.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Poisson}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Poisson</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/poisson.jl#L10-L14">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Rayleigh}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Laplace</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/rayleigh.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{Weibull}, ::Tuple{}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>Weibull</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/weibull.jl#L11-L15">source</a></section><section><div><pre><code class="language-julia hljs">partition_point(::Type{WishartFast}, ::Tuple{Int}, p, conditioner=nothing)</code></pre><p>Converts the <code>point</code> to a compatible representation for the natural manifold of type <code>WishartFast</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/natural_manifolds/wishart.jl#L11-L15">source</a></section></article><h2 id="Custom-generic-manifolds"><a class="docs-heading-anchor" href="#Custom-generic-manifolds">Custom generic manifolds</a><a id="Custom-generic-manifolds-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-generic-manifolds" title="Permalink"></a></h2><p><code>ExponentialFamilyManifolds.jl</code> introduces additional manifolds not included in <code>Manifolds.jl</code>. This is crucial because certain exponential family distributions have natural parameters that require specific manifolds, such as negative definite matrices for the multivariate Gaussian distribution. These manifolds do not implement every operation defined in <code>ManifoldsBase.jl</code>, but they do provide the essential operations needed for optimization with <code>Manopt.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.ShiftedPositiveNumbers" href="#ExponentialFamilyManifolds.ShiftedPositiveNumbers"><code>ExponentialFamilyManifolds.ShiftedPositiveNumbers</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ShiftedPositiveNumbers(shift)</code></pre><p>A manifold representing the positive numbers shifted by <code>shift</code>.  The points on this manifold are 1-dimensional vectors with a single element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/shifted_positive_numbers.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.ShiftedNegativeNumbers" href="#ExponentialFamilyManifolds.ShiftedNegativeNumbers"><code>ExponentialFamilyManifolds.ShiftedNegativeNumbers</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ShiftedNegativeNumbers(shift)</code></pre><p>A manifold representing the negative numbers shifted by <code>shift</code>. The points on this manifold are 1-dimensional vectors with a single element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/shifted_negative_numbers.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.SymmetricNegativeDefinite" href="#ExponentialFamilyManifolds.SymmetricNegativeDefinite"><code>ExponentialFamilyManifolds.SymmetricNegativeDefinite</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymmetricNegativeDefinite(k)</code></pre><p>This manifold represents the set of negative definite matrices of size <code>k × k</code>.  Similar to <code>SymmetricPositiveDefinite</code> from <code>Manifolds.jl</code> with the exception that the matrices are negative definite.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/symmetric_negative_definite.jl#L2-L7">source</a></section></article><h2 id="Optimization-example"><a class="docs-heading-anchor" href="#Optimization-example">Optimization example</a><a id="Optimization-example-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-example" title="Permalink"></a></h2><p>Suppose, we have a set of samples from a certain exponential family distribution and we want to estimate the natural parameters of the distribution using the <code>Manopt.jl</code> package.</p><pre><code class="language-julia hljs">using ExponentialFamily, Distributions, Plots, StableRNGs

rng  = StableRNG(42)
dist = Beta(24, 6)
data = rand(rng, dist, 200)

histogram(data, xlim = (0, 1), label = &quot;data&quot;, normalize=:pdf)</code></pre><img src="index-ad13c030.svg" alt="Example block output"/><pre><code class="language-julia hljs">using Manopt, ForwardDiff, ExponentialFamilyManifolds

# cost function
function f(M, p)
    ef = convert(ExponentialFamilyDistribution, M, p)
    return -sum((d) -&gt; logpdf(ef, d), data)
end

# gradient function
function g(M, p)
    return ForwardDiff.gradient((p) -&gt; f(M, p), p)
end

M = ExponentialFamilyManifolds.get_natural_manifold(Beta, ())
p = rand(rng, M)
q = gradient_descent(M, f, g, p)

q_ef = convert(ExponentialFamilyDistribution, M, q)
q_η  = getnaturalparameters(q_ef)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([20.396819066270247], [4.357726910129818])</code></pre><p>Note that we performed the optimization in the natural parameters space, we can use <code>ExponentialFamily.jl</code> API to convert the vector fo natural parameters to the corresponding mean parameter space:</p><pre><code class="language-julia hljs">map(NaturalParametersSpace() =&gt; MeanParametersSpace(), Beta, q_η)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 21.396819066270247
  5.357726910129818</code></pre><p>As we can see the result is quite close to the actual distribution, which was used to generate the test data:</p><pre><code class="language-julia hljs">params(MeanParametersSpace(), dist)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(24.0, 6.0)</code></pre><p>Let&#39;s also check the result, by plotting the estimated distribution on top of the data.</p><pre><code class="language-julia hljs">histogram(data, xlim = (0, 1), label = &quot;data&quot;, normalize=:pdf, fillalpha = 0.3)
plot!(0.0:0.01:1.0, (x) -&gt; pdf(dist, x), label = &quot;actual&quot;, fill = 0, fillalpha = 0.2)
plot!(0.0:0.01:1.0, (x) -&gt; pdf(q_ef, x), label = &quot;estimated&quot;, fill = 0, fillalpha = 0.5)</code></pre><img src="index-a726f27f.svg" alt="Example block output"/><p>The difference in KL is quite small as well:</p><pre><code class="language-julia hljs">kldivergence(convert(Distribution, q_ef), dist)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0035633924185827226</code></pre><h1 id="Helpers"><a class="docs-heading-anchor" href="#Helpers">Helpers</a><a id="Helpers-1"></a><a class="docs-heading-anchor-permalink" href="#Helpers" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExponentialFamilyManifolds.Negated" href="#ExponentialFamilyManifolds.Negated"><code>ExponentialFamilyManifolds.Negated</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Negated(m)</code></pre><p>Lazily negates the matrix <code>m</code>, without creating a new matrix.  Works by redefining the <code>getindex</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; using ExponentialFamilyManifolds

julia&gt; m = [1 2; 3 4]
2×2 Matrix{Int64}:
 1  2
 3  4

julia&gt; N = ExponentialFamilyManifolds.Negated(m)
2×2 ExponentialFamilyManifolds.Negated{Int64, Matrix{Int64}}:
 -1  -2
 -3  -4

julia&gt; N[1, 2]
-2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/ExponentialFamilyManifolds.jl/blob/86719e62e1695e998dd127f54a022d29598fab70/src/symmetric_negative_definite.jl#L136-L158">source</a></section></article><h1 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h1><ul><li><a href="#ExponentialFamilyManifolds.NaturalParametersManifold"><code>ExponentialFamilyManifolds.NaturalParametersManifold</code></a></li><li><a href="#ExponentialFamilyManifolds.Negated"><code>ExponentialFamilyManifolds.Negated</code></a></li><li><a href="#ExponentialFamilyManifolds.ShiftedNegativeNumbers"><code>ExponentialFamilyManifolds.ShiftedNegativeNumbers</code></a></li><li><a href="#ExponentialFamilyManifolds.ShiftedPositiveNumbers"><code>ExponentialFamilyManifolds.ShiftedPositiveNumbers</code></a></li><li><a href="#ExponentialFamilyManifolds.SymmetricNegativeDefinite"><code>ExponentialFamilyManifolds.SymmetricNegativeDefinite</code></a></li><li><a href="#ExponentialFamilyManifolds.get_natural_manifold"><code>ExponentialFamilyManifolds.get_natural_manifold</code></a></li><li><a href="#ExponentialFamilyManifolds.get_natural_manifold_base"><code>ExponentialFamilyManifolds.get_natural_manifold_base</code></a></li><li><a href="#ExponentialFamilyManifolds.partition_point"><code>ExponentialFamilyManifolds.partition_point</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 8 July 2024 11:13">Monday 8 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
